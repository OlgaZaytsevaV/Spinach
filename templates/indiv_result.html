{% extends "base.html" %}
{% block title %}Individual result{% endblock %}
{% block content %}
<h4>Results</h4>
  
<div class="container">
    <h2><b>{{name}}</b></h2>
<ul>
    {% for i in categories %}
        {{i['title']}}<br>
    {% endfor %}
</ul>
    <h5>Yelp Rating: {{rating}}</h5>
<ul>
    {% for i in locations['display_address'] %}
        {{"{}".format(i)}}
    {% endfor %}
</ul>
    <h5>Hours of operation:</h5> 
<ul>{% for day in days %}</ul>
    
    <li>{{day}}: {% for i in days[day]['hours'] %} <ul>{{i[0]}} - {{i[1]}}</ul></li>
    {% endfor %}
    {% endfor %}
<ul>
    {% if is_open_now == True %} 
    <p style="color: green">Open now</p>  
    {% else %} 
    <p style="color: red">Closed now</p>
    {% endif %}
 
  
</ul>            
    <h5><a href="tel:{{phone}}">{{phone}}</a></h5>
<ul>
    {% if "user_id" in session %}
    <form action="/save" id="myform" method="POST">
        <input type="text" id="name" value="{{name}}" name="name" hidden="hidden">
        <input type="text" id="yelp_id" value="{{yelp_id}}" name="yelp_id" hidden="hidden">
        <button type="submit" id="savebutton" name="save" value="save">Save this place</button>
    </form>
    <form action="/ratings" id="ratings">
    <div>
        <input type="text" id="name" value="{{name}}" name="name" hidden="hidden">
        <input type="text" id="yelp_id" value="{{yelp_id}}" name="yelp_id" hidden="hidden"> 
        <input type='number' id='rating' name='rating' class="rating rating-loading" data-min="1" data-max="5" data-step="1" value="0" required><br>
    </div>
    </form>
    {% endif %}
 </ul>
<script>

        

       
        // let button = document.querySelector("#myform");  
        function showAlert(results) {
            alert(results);
        } 

        function submitPlace(evt) {
            evt.preventDefault();
            let formInputs = {
                "yelp_id": $("#yelp_id").val(),
                "name": $("#name").val(),
            };    
            $.post('/save', formInputs, showAlert);     
            
        }
        $("#myform").on('submit', submitPlace);
        //button.addEventListener('submit', submitPlace);
        // select button
        // add event listener to button with submitPlace as callback
        // submit Place should make a post ajax request to the server.
        // function showAlert(results) {
        //     alert("Hi");
        // }

        function submitRatings(evt) {
            console.log("submitRatings");
            evt.preventDefault();
            let formInputs = {
                "yelp_id": $("#yelp_id").val(),
                "name": $("#name").val(),
                "rating" : $("#rating").val(),
            };
            $.post('/ratings', formInputs, showAlert);
        }
        $("#ratings").on('click', submitRatings);   



   

</script>

  <style>
          .star-rating {
          line-height:40px;
          font-size:1.5em;
        }
        .star-rating .fa-star{color: yellow;}
  </style>
   <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script>
    $( document ).ready(function() {
        console.log( "document loaded" );
    });
 
    $( window ).on( "load", function() {
        console.log( "window loaded" );
    });
    </script>



    <h5>Price:{{price}}</h5>
    {% for i in photos %}
        <li><img src ="{{i}}" style="width: 30%; height: 30%" /></li><br>
    {% endfor %}
    
{% endblock %}

